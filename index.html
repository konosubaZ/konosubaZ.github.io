<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>为美好世界献上代码</title>
    <meta name="keywords" content="动画,漫画,游戏,偶尔前端的原创博客"/>
    <meta name="description" content="Konosuba！"/>
    <meta name="generator" content="emlog"/>
    <meta itemprop="name" content="为美好世界献上代码 "/>
    <link rel="icon" href="fonts/icon/icon.jpg" sizes="32x32">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/swiper.css">
    <link rel="stylesheet" href="css/dman.css">
    <link rel="stylesheet" type="text/css" href="live2d/assets/waifu.css"/>
    <link rel="stylesheet" href="fonts/aside/aside-top/iconfont.css">
    <script src="js/jquery.js"></script>
</head>
<body id="bg">
<div id="home">
    <div class="zero-preview">
        <div class="zero-box">
            <img class="zero-img" src="" alt="">
        </div>
    </div>
    <nav class="navbar navbar-default navbar-fixed-top"></nav>
    <div id="topimg">
        <div class="topimg-info">
            <div class="ctaBox">
                <a class="cta">この素晴らしい世界に祝福を！</a>
            </div>
            <div class="header-info">
            </div>
        </div>
    </div>
    <script>
        $('.navbar').load('public/index/nav/index.html', function (responseTxt, statusTxt, xhr) {
            console.log('responseTxt,statusTxt,xhr')
        })

        let $cta = $('.cta');
        let createBtnsMarkup = () => {
            $cta.each((i, btn) => {
                let $t = $(btn);
                let $btnText = $t.text();
                let $splitText = $btnText.split("");

                $t.html("").append(`
				<span class="btn-text-parent">
					<span class="wrap_text current-btn-text"></span>
					<span class="wrap_text buildin-btn-text"></span>
				</span>
			`);

                for (let i = 0; i < $splitText.length; i++) {
                    $t.find(".wrap_text").append(`<span class="btn-letter">${$splitText[i]}</span>`);
                }
            });
        };


        window.onLoad = createBtnsMarkup();
    </script>
    <div class="wavebox">
        <div class="waveWrapper waveAnimation">
            <div class="waveWrapperInner bgTop">
                <div class="wave waveTop" style="background-image: url('fonts/wave/wave-top.png')"></div>
            </div>
            <div class="waveWrapperInner bgMiddle">
                <div class="wave waveMiddle" style="background-image: url('fonts/wave/wave-mid.png')"></div>
            </div>
            <div class="waveWrapperInner bgBottom">
                <div class="wave waveBottom" style="background-image: url('fonts/wave/wave-bot.png')"></div>
            </div>
        </div>
    </div>
    <div id="box">
        <div class="space">
            <div class="banner">
                <div class="swiper-container swiper1">
                    <div class="swiper-wrapper">
                    </div>
                </div>
            </div>
            <script type="text/javascript">
                var bannerData = function (data) {
                    for (var i = 0; i < data.length; i++) {
                        var slide = document.createElement('div');
                        var slideimg = document.createElement('div');
                        var img = document.createElement('img');
                        slide.className = 'swiper-slide';
                        slideimg.className = 'slide-img';
                        img.className = 'img';
                        img.src = data[i];
                        slideimg.appendChild(img);
                        slide.appendChild(slideimg);
                        var swiper1 = document.getElementsByClassName('swiper1')[0];
                        var wrapper = swiper1.firstElementChild;
                        wrapper.appendChild(slide);
                    }
                };
                // // 提供jsonp服务的url地址（不管是什么类型的地址，最终生成的返回值都是一段javascript代码）
                // var url = "https://konosubaz.github.io/public/admin/api/indexData.js";
                // // 创建script标签，设置其属性
                // var script = document.createElement('script');
                // script.setAttribute('src', url);
                // // 把script标签加入head，此时调用开始
                // document.getElementsByTagName('head')[0].appendChild(script);
                $(".swiper-wrapper").on('mouseenter', '.img', function (e) {
                    $(this).stop().css('transform', 'scale(1.2)').css('filter', 'blur(5px)');
                }).on('mouseout', '.img', function (e) {
                    $(this).stop().css('transform', 'scale(1)').css('filter', 'blur(0)');
                });
                $(".swiper-wrapper").on('click', '.img', function (e) {
                    var imgSrc = $(this).context.currentSrc;
                    $('.zero-preview').css({'opacity': '1', 'z-index': '99999'});
                    $('.zero-preview').find('img').attr('src', imgSrc);
                });

            </script>
            <div class="animate-recommend">
                <div class="title">
                    <span class="title-icon icon_o"></span>
                    <h1>不是阿宅不戳进来</h1>
                    <div class="exchange">
                        <span class="glyphicon glyphicon-refresh"></span>
                        <span>换一换</span>
                    </div>
                </div>
                <div class="recommend-content">
                    <div class="row">
                    </div>
                </div>
            </div>
            <div class="advert"></div>
            <div class="recent-news">
                <div class="title">
                    <span class="title-icon icon_t"></span>
                    <h1>不是阿宅不看过来</h1>
                </div>
                    <div class="news-box">
                </div>
            </div>
            <div class="load-more">
                <a href="javascript:;">
                    more
                </a>
            </div>
        </div>
        <div class="aside">
            <span class="iconfont icon-star top-label"></span>
            <p>热玩榜</p>
            <div class="aside-box">
                <div class="item">
                    明日方舟
                </div>
                <div class="item">
                    月圆之夜
                </div>
                <div class="item">
                    战双
                </div>
                <div class="item">
                    崩坏3rd
                </div>
                <div class="item">
                    阴阳师
                </div>
                <div class="item">
                    碧蓝航线
                </div>
                <div class="item">
                    FG0
                </div>
                <div class="item">
                    双生视界
                </div>
                <div class="item">
                    机动战队
                </div>
                <div class="item">
                    少女前线
                </div>
            </div>
            <div class="goback">
                <span class="iconfont icon-arrowtopdot"></span>
            </div>
        </div>
        <script>
            $(window).scroll(function(){
                var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
                if(scrollTop >= 969){
                    $('.aside').css({
                        'position':'fixed',
                        'top':'80px'
                    })
                }else{
                    $('.aside').css({
                        'position':'absolute',
                        'top':'20px'
                    })
                }
            })
        </script>
    </div>
    <div id="live2d-box">
        <div class="waifu" id="waifu">
            <div class="waifu-tips" style="opacity: 1;"></div>
            <canvas id="live2d" width="280" height="250" class="live2d"></canvas>
            <div class="waifu-tool">
                <span class="fui-home"></span>
                <span class="fui-chat"></span>
                <span class="fui-eye"></span>
                <span class="fui-user"></span>
                <span class="fui-photo"></span>
                <span class="fui-info-circle"></span>
                <span class="fui-cross"></span>
            </div>
        </div>
        <script src="live2d/assets/live2d.js"></script>
        <script src="live2d/assets/waifu-tips.js"></script>
        <script type="text/javascript">initModel()</script>
    </div>
    <foot class="footer"></foot>
    <script>
        $('.footer').load('public/index/foot/index.html', function (responseTxt, statusTxt, xhr) {
            console.log('responseTxt,statusTxt,xhr')
        })
    </script>
</div>
<script src="https://konosubaz.github.io/public/admin/api/indexData.js"></script>
<script src="js/jquery.parallax-scroll.js"></script>
<script>
    $(window).scroll(function () {
        var scrolled = $(this).scrollTop();
        $('#topimg').css('top', (0 + (scrolled * .6)) + 'px');
    });
    document.onkeydown = function (event) {
        var e = event || window.event || arguments.callee.caller.arguments[0];
        if (e && e.keyCode == 27) { // 按 Esc
            //要做的事情
            $('.zero-preview').css({'opacity': '0', 'z-index': '0'});
        }
        if (e && e.keyCode == 113) { // 按 F2
            //要做的事情
        }
        if (e && e.keyCode == 13) { // enter 键
            //要做的事情
        }
    }
</script>
<script src="js/bootstrap.js"></script>
<script src="js/swiper.js"></script>
<script src="js/animate.js"></script>
<script type="text/javascript">
    var list = [];
    var newsData = [];
    var newslist = [];
    animateData();

    function animateData() {
        $.ajax({
            //请求方式为get
            type: "GET",
            //json文件位置
            url: "https://konosubaz.github.io/public/admin/api/index.json",
            //返回数据格式为json
            dataType: "json",
            //请求成功完成后要执行的方法
            success: function (data) {
                list = data.list;
                newslist = data.news;

                createDiv();
                createNews();

                $('.recommend-item').hover(function () {
                    $(this).find('img').stop().css('transform', 'scale(1.2)');
                    $(this).find('.recommend-table').stop().animate({bottom: '-25px'}, 200);
                }, function () {
                    $(this).find('img').stop().css('transform', 'scale(1)');
                    $(this).find('.recommend-table').stop().animate({bottom: '5px'}, 200);
                })
            }
        });
    }

    // and the result is...
    Array.prototype.shuffle = function () {
        var input = this;
        for (var i = input.length - 1; i >= 0; i--) {
            var randomIndex = Math.floor(Math.random() * (i + 1));
            var itemAtIndex = input[randomIndex];
            input[randomIndex] = input[i];
            input[i] = itemAtIndex;
        }
        return input;
    }
    $('.exchange').click(function () {
        list.shuffle();
        $.ajax({
            //请求方式为get
            type: "GET",
            //json文件位置
            url: "https://konosubaz.github.io/public/admin/api/index.json",
            //返回数据格式为json
            dataType: "json",
            //请求成功完成后要执行的方法
            success: function (data) {
                createDiv();
                $('.recommend-item').hover(function () {
                    $(this).find('img').stop().css('transform', 'scale(1.2)');
                    $(this).find('.recommend-table').stop().animate({bottom: '-25px'}, 200);
                }, function () {
                    $(this).find('img').stop().css('transform', 'scale(1)');
                    $(this).find('.recommend-table').stop().animate({bottom: '5px'}, 200);
                })
            }
        });
        var timer;
        var spanIcon = $(this).find('span').eq(0);
        clearTimeout(timer);
        if (spanIcon.hasClass('xuanz')) {
            spanIcon.removeClass('xuanz');
        } else {
            spanIcon.addClass('xuanz');
            timer = setTimeout(function () {
                spanIcon.removeClass('xuanz');
            }, 500);
        }
    });

    function createDiv() {
        var html = [];
        for (var i = 0; i < 8; i++) {
            var divAnimate =
                '<div class="col-md-3 col-xs-6">' +
                '<div class="recommend-item">' +
                '<div class="recommend-item-cover">' +
                '<img src="' + list[i].imgUrl + '" alt="">' +
                '</div>' +
                '<div class="recommend-item-msg">' +
                '<h3>' + list[i].title + '</h3>' +
                '<div class="recommend-table">' +
                '<div class="table-item">' +
                '<span class="glyphicon glyphicon-play-circle"></span>' +
                '<p>' + list[i].play + '</p>' +
                '</div>' +
                '<div class="table-item">' +
                '<span class="glyphicon glyphicon-list-alt"></span>' +
                '<p>' + list[i].comments + '</p>' +
                '</div>' +
                '<div class="table-item">' +
                '<span class="glyphicon glyphicon-phone"></span>' +
                '<p>' + list[i].mobile + '</p>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</div>';
            html.push(divAnimate);
            var row = $('div.recommend-content').find('div.row');
            row.html(html)
        }
    }

    function createNews() {
        for (var n = 0; n < newslist.length; n++) {
            var news = '  <div class="news-item">' +
                '<div class="row">' +
                ' <div class="col-md-4">' +
                '<div class="news-item-cover">' +
                ' <img src="' + newslist[n].imgUrl + '" alt="">' +
                '</div>' +
                '</div>' +
                '<div class="col-md-8">' +
                '<div class="news-item-msg">' +
                '<p class="clearfix-title">' + newslist[n].title + '</p>' +
                '<div class="tags">' +
                ' <span><a href="javascript:;">' + newslist[n].targ.time + '</a></span>' +
                ' <span><a href="javascript:;">' + newslist[n].targ.user + '</a></span>' +
                '  <span><a href="javascript:;">' + newslist[n].targ.type + '</a></span>' +
                ' </div>' +
                '<div class="details">' +
                '<p>' + newslist[n].info + '</p>' +
                '</div>' +
                '<div class="more-btn">' +
                '  <a href="javascript:;">Read More</a>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</div>';
            newsData.push(news);
            var nwebox = $('.news-box');
            nwebox.html(newsData);
        }
    }
</script>
</body>
</html>
